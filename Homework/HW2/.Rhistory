0.02 * 0.5
0.02*0.05 + 0.03*0.3 + 0.05*0.2
0.01/0.02
0.02*0.5 + 0.03*0.3 + 0.05*0.2
0.01/0.029
# First year
Pmaledies80 <- 0.056237
Pfemdies75 <- 0.024080
Patleastone <- 1 - (Pmaledies80 * Pfemdies75)
V1 = 1000 / (1.05) * Patleastone
V1
Patleastone
# Second Year
Pmaledies81 <- 0.062360
Pfemdies76 <- 0.026831
# Case 1, both survive 2 years
PbothSurv2 <-
(1 - Pmaledies80) * (1 - Pmaledies81) * (1 - Pfemdies75) * (1 - Pfemdies76)
#PbothSurv2
#Case 2, Fem lives 2 years, males dies year 1
Pfem2male1 <- Pmaledies80 * (1 - Pfemdies75) * (1 - Pfemdies76)
# Case 3 Fem lives 2, male dies year 2
Pfem2male2 <- (1 - Pmaledies80) * (Pmaledies81) * (1 - Pfemdies75) * (1 - Pfemdies76)
#Case 4 Male survives 2 years, fem dies year 1
Pmale2fem1 <- (1 - Pmaledies80) * (1 - Pmaledies81) * (Pfemdies75)
#Case 5 Male survies 2 years, fem dies year 2
Pmale2fem2 <- (1 - Pmaledies80) * (1 - Pmaledies81) * (1 - Pfemdies75) * (Pfemdies76)
V2 <-
(1000 / (1.05) ^ 2) * (PbothSurv2 + Pfem2male1 + Pfem2male2 + Pmale2fem1 + Pfem2male2)
V2
(PbothSurv2 + Pfem2male1 + Pfem2male2 + Pmale2fem1 + Pfem2male2)
PbothSurv2
Pfem2male1
# Second Year
Pmaledies81 <- 0.062360
Pfemdies76 <- 0.026831
# Case 1, both survive 2 years
PbothSurv2 <-
(1 - Pmaledies80) * (1 - Pmaledies81) * (1 - Pfemdies75) * (1 - Pfemdies76)
PbothSurv2
#Case 2, Fem lives 2 years, males dies year 1
Pfem2male1 <- Pmaledies80 * (1 - Pfemdies75) * (1 - Pfemdies76)
Pfem2male1
# Case 3 Fem lives 2, male dies year 2
Pfem2male2 <- (1 - Pmaledies80) * (Pmaledies81) * (1 - Pfemdies75) * (1 - Pfemdies76)
#Case 4 Male survives 2 years, fem dies year 1
Pmale2fem1 <- (1 - Pmaledies80) * (1 - Pmaledies81) * (Pfemdies75)
#Case 5 Male survies 2 years, fem dies year 2
Pmale2fem2 <- (1 - Pmaledies80) * (1 - Pmaledies81) * (1 - Pfemdies75) * (Pfemdies76)
V2 <-
(1000 / (1.05) ^ 2) * (PbothSurv2 + Pfem2male1 + Pfem2male2 + Pmale2fem1 + Pmale2fem2)
V2
# Second Year
Pmaledies81 <- 0.062360
Pfemdies76 <- 0.026831
# Case 1, both survive 2 years
PbothSurv2 <-
(1 - Pmaledies80) * (1 - Pmaledies81) * (1 - Pfemdies75) * (1 - Pfemdies76)
#Case 2, Fem lives 2 years, males dies year 1
Pfem2male1 <- Pmaledies80 * (1 - Pfemdies75) * (1 - Pfemdies76)
# Case 3 Fem lives 2, male dies year 2
Pfem2male2 <- (1 - Pmaledies80) * (Pmaledies81) * (1 - Pfemdies75) * (1 - Pfemdies76)
#Case 4 Male survives 2 years, fem dies year 1
Pmale2fem1 <- (1 - Pmaledies80) * (1 - Pmaledies81) * (Pfemdies75)
#Case 5 Male survies 2 years, fem dies year 2
Pmale2fem2 <- (1 - Pmaledies80) * (1 - Pmaledies81) * (1 - Pfemdies75) * (Pfemdies76)
V2 <-
(1000 / (1.05) ^ 2) * (PbothSurv2 + Pfem2male1 + Pfem2male2 + Pmale2fem1 + Pmale2fem2)
V2
#Value after 2 years
V1 + V2
data(tongue)
head(tongue)
library(survival)
library(KMsurv)
library(ggplot2)
library(ggpubr)
install.packages('ggpubr')
library(survminer)
install.packages(survminer)
install.packages("survminer")
install.packages("muhaz")
library(survival)
library(KMsurv)
library(ggplot2)
library(ggpubr)
library(survminer)
library(plotly)
library(muhaz)
data(tongue)
head(tongue)
survival <- Surv(time = tongue$time, event = tongue$delta)
KMcurves <- survfit(survival ~ type, data = tongue)
KMplot <- ggsurvplot(KMcurves) + labs(title = "KM Curves with Censor Marks")
KMplotCI <- ggsurvplot(KMcurves, conf.int = 0.95) + labs(title = "KM Curves with Censor Marks")
ggplotly(KMplot[[1]])
#Plotly does not have ggplot confidence intervals built in yet
KMplotCI
#Cumulative Hazard plot
cumHazPlot <-
ggsurvplot(
NAcurves,
fun = "cumhaz",
palette = c("#581845", "#FFC300"),
ggtheme = theme_light()
) + ggtitle("Cumulative Hazard for Aneuploid and Diploid Tumors")
survdiff(survival ~ type, data = tongue)
NAcurves <-
survfit(survival ~ type, type = "fleming-harrington", data = tongue)
NAplot <-
ggsurvplot(NAcurves) + labs(title = "NA Curves with Censor Marks")
ggplotly(NAplot[[1]])
fit <- list(NelAal = NAcurves, KapMei = KMcurves)
#Comparison of KM versus NA
# https://stackoverflow.com/questions/64749137/merge-two-kaplan-meier-curve-with-ggsurvplot
compPlot <-
ggsurvplot_combine(fit, data = tongue) + labs(title = "Comparison of Nelson-Aalen Curves to Kaplan-Meier")
ggplotly(compPlot[[1]])
timevec <- 1:1000
#First hazard
sf1 <- stepfun(NAcurves[1]$time, c(1, NAcurves[1]$surv))
#Second Hazard
sf2 <- stepfun(NAcurves[2]$time, c(1, NAcurves[2]$surv))
#Cumulative hazard
cumhaz1 <- -log(sf1(timevec))
cumhaz2 <- -log(sf2(timevec))
#Cumulative Hazard
# ggplotly(
#   ggplot() + aes(x = timevec, y = cumhaz1) + geom_line(color = "#581845") + ggtitle("Hazard Ratio for Type of Tumor")
# )
#Cumulative Hazard plot
cumHazPlot <-
ggsurvplot(
NAcurves,
fun = "cumhaz",
palette = c("#581845", "#FFC300"),
ggtheme = theme_light()
) + ggtitle("Cumulative Hazard for Aneuploid and Diploid Tumors")
ggplotly(cumHazPlot[[1]])
#Hazard Ratio
ggplotly(
ggplot(ggtheme = theme_light()) + aes(x = timevec, y = cumhaz1 / cumhaz2) + geom_line(color = "#FF5733") + ggtitle("Hazard Ratio for Type of Tumor")
)
# Smoothed Hazard
fit1 <- muhaz(tongue$time, tongue$delta, tongue$type == 1)
fit2 <- muhaz(tongue$time, tongue$delta, tongue$type == 2)
#Smoothed Hazard Rates Plots
ggplotly(
ggplot()  + geom_line(aes(
x = fit1$est.grid, y = fit1$bw.loc.sm, color = "Aneuploid"
)) + geom_line(aes(
x = fit2$est.grid, y = fit2$bw.loc.sm, color = "Diploid"
)) + labs(title = "Smoothed Hazard Rate Type of Tumor") + xlab("Follow-Up Time") + ylab("Hazard Rate") + scale_color_manual(name = "Tumor Type", values= c("Aneuploid" = "#FF5733", "Diploid" = "#C70039"))
)
timevec <- 1:1000
#First hazard
sf1 <- stepfun(NAcurves[1]$time, c(1, NAcurves[1]$surv))
#Second Hazard
sf2 <- stepfun(NAcurves[2]$time, c(1, NAcurves[2]$surv))
#Cumulative hazard
cumhaz1 <- -log(sf1(timevec))
cumhaz2 <- -log(sf2(timevec))
#Cumulative Hazard
# ggplotly(
#   ggplot() + aes(x = timevec, y = cumhaz1) + geom_line(color = "#581845") + ggtitle("Hazard Ratio for Type of Tumor")
# )
#Cumulative Hazard plot
cumHazPlot <-
ggsurvplot(
NAcurves,
fun = "cumhaz",
palette = c("#581845", "#FFC300"),
ggtheme = theme_light()
) + ggtitle("Cumulative Hazard for Aneuploid and Diploid Tumors")
ggplotly(cumHazPlot[[1]])
#Hazard Ratio
ggplotly(
ggplot(ggtheme = theme_light()) + aes(x = timevec, y = cumhaz1 / cumhaz2) + geom_line(color = "#FF5733") + ggtitle("Hazard Ratio for Type of Tumor")
)
# Smoothed Hazard
fit1 <- muhaz(tongue$time, tongue$delta, tongue$type == 1)
fit2 <- muhaz(tongue$time, tongue$delta, tongue$type == 2)
#Smoothed Hazard Rates Plots
ggplotly(
ggplot()  + geom_line(aes(
x = fit1$est.grid, y = fit1$bw.loc.sm, color = "Aneuploid"
)) + geom_line(aes(
x = fit2$est.grid, y = fit2$bw.loc.sm, color = "Diploid"
)) + labs(title = "Smoothed Hazard Rate Type of Tumor") + xlab("Follow-Up Time") + ylab("Hazard Rate") + scale_color_manual(name = "Tumor Type", values= c("Aneuploid" = "#FF5733", "Diploid" = "#C70039"))
)
